–í–æ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π –ø—Ä–æ–º—Ç –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —Ç–µ–º—ã –∫—É—Ä—Å–∞ **"–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —è–¥—Ä–∞ Linux"**, —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å **–¥–µ—Ä–µ–≤—å—è–º–∏ –≤ —è–¥—Ä–µ Linux (–±–∏–Ω–∞—Ä–Ω—ã–µ –∏ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã–µ)**, –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–µ –≥–ª—É–±–æ–∫–æ–µ –æ—Å–≤–æ–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ —Å –ø—Ä–∞–∫—Ç–∏–∫–æ–π:

---

### üéì **–ü—Ä–æ–º—Ç –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —Ç–µ–º—ã: "–î–µ—Ä–µ–≤—å—è –≤ —è–¥—Ä–µ Linux (–±–∏–Ω–∞—Ä–Ω—ã–µ –∏ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã–µ)"**

üîç **–¶–µ–ª—å –ø—Ä–æ–º—Ç–∞:**
–°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —É—á–µ–±–Ω—ã–π –º–æ–¥—É–ª—å —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏ —Ä–µ–∞–ª–∏–∑—É—é—Ç—Å—è –±–∏–Ω–∞—Ä–Ω—ã–µ –∏ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è –≤ —è–¥—Ä–µ Linux. –ò–∑—É—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Å–ª—É—á–∞–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¥—Ä–∞–π–≤–µ—Ä–∞—Ö –∏ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–∏ –ø—Ä–∏–º–µ—Ä—ã –º–æ–¥—É–ª–µ–π —è–¥—Ä–∞.

---

### üìå **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è ChatGPT (–¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)**

**–ó–∞–¥–∞—á–∞:**
–°—Ñ–æ—Ä–º–∏—Ä—É–π –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ–±—É—á–∞—é—â–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª –ø–æ —Ç–µ–º–µ **"–î–µ—Ä–µ–≤—å—è –≤ —è–¥—Ä–µ Linux (–±–∏–Ω–∞—Ä–Ω—ã–µ –∏ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã–µ)"**, –≤–∫–ª—é—á–∞—é—â–∏–π:

#### 1. **–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫—É—é —á–∞—Å—Ç—å**

* –ß—Ç–æ —Ç–∞–∫–æ–µ –±–∏–Ω–∞—Ä–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è –∏ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è, –∏—Ö –æ—Ç–ª–∏—á–∏–µ, —Å–≤–æ–π—Å—Ç–≤–∞ –∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞.
* –ö–∞–∫–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ API –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —è–¥—Ä–µ Linux –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

  * `struct rb_node`
  * `struct rb_root`
  * –ú–∞–∫—Ä–æ—Å—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ `linux/rbtree.h`
* –ü—Ä–∏–Ω—Ü–∏–ø—ã –≤—Å—Ç–∞–≤–∫–∏, —É–¥–∞–ª–µ–Ω–∏—è –∏ –ø–æ–∏—Å–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

#### 2. **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —è–¥—Ä–µ Linux**

* –ü—Ä–∏–º–µ—Ä—ã –∏–∑ —è–¥—Ä–∞ (—Å—Å—ã–ª–∫–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏ –∫–æ–¥–∞ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ Linux):

  * –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `rbtree` –≤ VFS
  * –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á –∏–ª–∏ –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é
  * –¥—Ä—É–≥–∏–µ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–µ–π—Å—ã, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–µ—Ä–µ–≤—å—è

#### 3. **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å**

* –ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç–æ–≥–æ –º–æ–¥—É–ª—è —è–¥—Ä–∞, —Ä–µ–∞–ª–∏–∑—É—é—â–µ–≥–æ –≤—Å—Ç–∞–≤–∫—É, —É–¥–∞–ª–µ–Ω–∏–µ –∏ –ø–æ–∏—Å–∫ —É–∑–ª–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º API `rbtree.h`
* –í—Ç–æ—Ä–æ–π –ø—Ä–∏–º–µ—Ä ‚Äì –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –¥—Ä–∞–π–≤–µ—Ä–∞ (–∏–ª–∏ –∏–º–∏—Ç–∞—Ü–∏—è) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–µ—Ä–µ–≤—å–µ–≤
* –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Å–±–æ—Ä–∫–µ –∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥—É–ª–µ–π: Makefile, `insmod`, `rmmod`, `dmesg`

#### 4. **–ó–∞–¥–∞–Ω–∏—è –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã**

* –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–≤–æ–π –º–æ–¥—É–ª—å —è–¥—Ä–∞ —Å –¥–µ—Ä–µ–≤–æ–º, —Ö—Ä–∞–Ω—è—â–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø–æ PID)
* –°—Ä–∞–≤–Ω–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ª–∏–Ω–µ–π–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –∏ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞

#### 5. **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã**

* –ì–æ—Ç–æ–≤—ã–π –∫–æ–Ω—Å–ø–µ–∫—Ç –ª–µ–∫—Ü–∏–∏ (–º–æ–∂–Ω–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Markdown)
* –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å:

  * –∏—Å—Ö–æ–¥–Ω–∏–∫–∞–º–∏ –º–æ–¥—É–ª–µ–π
  * Makefile'–∞–º–∏
  * README —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏

---

### üìÇ **–ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –≤ ChatGPT**

> "–°–æ–∑–¥–∞–π –æ–±—É—á–∞—é—â–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª –ø–æ —Ç–µ–º–µ '–î–µ—Ä–µ–≤—å—è –≤ —è–¥—Ä–µ Linux (–±–∏–Ω–∞—Ä–Ω—ã–µ –∏ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã–µ)', –≤–∫–ª—é—á–∞—è:
>
> * –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `rb_node`, `rb_root`, –º–∞–∫—Ä–æ—Å–æ–≤ –∏ —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ `rbtree.h`
> * —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏ –∫–æ–¥–∞ —è–¥—Ä–∞ Linux, –≥–¥–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –¥–µ—Ä–µ–≤—å—è
> * –¥–≤–∞ –ø—Ä–∏–º–µ—Ä–∞ –º–æ–¥—É–ª–µ–π —è–¥—Ä–∞: –ø—Ä–æ—Å—Ç–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω—ã–π –∫ —Ä–µ–∞–ª—å–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–º–∏—Ç–∞—Ü–∏—è –¥—Ä–∞–π–≤–µ—Ä–∞)
> * –∑–∞–¥–∞–Ω–∏—è –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã
> * –∏—Ç–æ–≥–æ–≤—ã–π –∫–æ–Ω—Å–ø–µ–∫—Ç –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏"

---

### üßë‚Äçüè´ **–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å:**

–ö–æ—Ä–æ–±–µ–π–Ω–∏–∫–æ–≤ –ì–ª–µ–±

### üõ† **–ö–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏:**

* –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ API —è–¥—Ä–∞ Linux –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö
* –í—ã–±–æ—Ä –∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–ª—è –º–æ–¥—É–ª–µ–π —è–¥—Ä–∞
* –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ rbtree –∏ –±–∏–Ω–∞—Ä–Ω—ã—Ö –¥–µ—Ä–µ–≤—å–µ–≤ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —è –º–æ–≥—É —Å—Ä–∞–∑—É –Ω–∞—á–∞—Ç—å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —É—á–µ–±–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª, –≤–∫–ª—é—á–∞—è:

* –∫–æ–Ω—Å–ø–µ–∫—Ç –ª–µ–∫—Ü–∏–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Markdown,
* –ø—Ä–∏–º–µ—Ä—ã –º–æ–¥—É–ª–µ–π —è–¥—Ä–∞,
* —Å—Å—ã–ª–∫–∏ –Ω–∞ —É—á–∞—Å—Ç–∫–∏ –∫–æ–¥–∞ –≤ Linux kernel.


–û—Ç–ª–∏—á–Ω–æ! –î–∞–≤–∞–π—Ç–µ –ø—Ä–∏—Å—Ç—É–ø–∏–º –∫ —Å–æ–∑–¥–∞–Ω–∏—é –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ —É—á–µ–±–Ω–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –ø–æ —Ç–µ–º–µ ¬´–î–µ—Ä–µ–≤—å—è –≤ —è–¥—Ä–µ Linux (–±–∏–Ω–∞—Ä–Ω—ã–µ –∏ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã–µ)¬ª. –≠—Ç–æ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –æ—Å–≤–æ–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç—Ç–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –º–æ–¥—É–ª–µ–π —è–¥—Ä–∞ Linux.

---

## üìò –ö–æ–Ω—Å–ø–µ–∫—Ç –ª–µ–∫—Ü–∏–∏: ¬´–î–µ—Ä–µ–≤—å—è –≤ —è–¥—Ä–µ Linux¬ª

### 1. –í–≤–µ–¥–µ–Ω–∏–µ –≤ –±–∏–Ω–∞—Ä–Ω—ã–µ –∏ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è

**–ë–∏–Ω–∞—Ä–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è –ø–æ–∏—Å–∫–∞ (BST)** ‚Äî —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É—Å–ª–æ–≤–∏–µ: –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ª–µ–≤–æ–º –ø–æ–¥–¥–µ—Ä–µ–≤–µ –º–µ–Ω—å—à–µ –∑–Ω–∞—á–µ–Ω–∏—è —É–∑–ª–∞, –∞ –≤ –ø—Ä–∞–≤–æ–º ‚Äî –±–æ–ª—å—à–µ. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫, –≤—Å—Ç–∞–≤–∫—É –∏ —É–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–æ —Å—Ä–µ–¥–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é O(log n).

**–ö—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è** ‚Äî —ç—Ç–æ —Å–∞–º–æ–±–∞–ª–∞–Ω—Å–∏—Ä—É—é—â–∏–µ—Å—è –±–∏–Ω–∞—Ä–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è –ø–æ–∏—Å–∫–∞, –∫–æ—Ç–æ—Ä—ã–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤—ã—Å–æ—Ç—É O(log n) –∑–∞ —Å—á–µ—Ç —Å–æ–±–ª—é–¥–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∂–¥—ã–π —É–∑–µ–ª –ª–∏–±–æ –∫—Ä–∞—Å–Ω—ã–π, –ª–∏–±–æ —á–µ—Ä–Ω—ã–π, –∫–æ—Ä–µ–Ω—å –≤—Å–µ–≥–¥–∞ —á–µ—Ä–Ω—ã–π –∏ —Ç.–¥.).

–í —è–¥—Ä–µ Linux –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã—Ö –¥–µ—Ä–µ–≤—å–µ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `rb_node`, –∞ –¥–ª—è –∫–æ—Ä–Ω—è –¥–µ—Ä–µ–≤–∞ ‚Äî `rb_root`. –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –Ω–∏–º–∏ –≤–∫–ª—é—á–∞—é—Ç –≤—Å—Ç–∞–≤–∫—É, —É–¥–∞–ª–µ–Ω–∏–µ –∏ –ø–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

---

### 2. API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–µ—Ä–µ–≤—å—è–º–∏ –≤ —è–¥—Ä–µ Linux

–í —è–¥—Ä–µ Linux –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã–º–∏ –¥–µ—Ä–µ–≤—å—è–º–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è API, –≤–∫–ª—é—á–∞—é—â–µ–µ —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –º–∞–∫—Ä–æ—Å—ã:

* `RB_ROOT` ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ –¥–µ—Ä–µ–≤–∞.
* `rb_insert_color()` ‚Äî –≤—Å—Ç–∞–≤–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –¥–µ—Ä–µ–≤–æ —Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π.
* `rb_erase()` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–∑ –¥–µ—Ä–µ–≤–∞.
* `rb_next()` / `rb_prev()` ‚Äî –∏—Ç–µ—Ä–∞—Ü–∏—è –ø–æ –¥–µ—Ä–µ–≤—É.
* `rb_first()` / `rb_last()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ/–ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞.

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```c
#include <linux/rbtree.h>

struct rb_root my_tree = RB_ROOT;

struct rb_node *node;
struct my_data *data;

rb_insert_color(&my_node, &my_tree);
```

---

### 3. –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —è–¥—Ä–µ Linux

–ö—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞—Ö —è–¥—Ä–∞ Linux:

* **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ Completely Fair Scheduler (CFS)**: –î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ, –≥–¥–µ –∫–ª—é—á–æ–º —è–≤–ª—è–µ—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ (vruntime). –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –∑–∞–¥–∞—á—É —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º vruntime –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

* **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é**: –í –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞—Ö —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é, —Ç–∞–∫–∏—Ö –∫–∞–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏, —Ç–∞–∫–∂–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±–ª–∞—Å—Ç—è–º–∏ –ø–∞–º—è—Ç–∏.

* **–§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ Btrfs**: –í Btrfs –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–µ—Ä–µ–≤—å—è –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º.

---

### 4. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å: —Å–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥—É–ª—è —è–¥—Ä–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–µ—Ä–µ–≤—å–µ–≤

**–ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π –º–æ–¥—É–ª—å —è–¥—Ä–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞**

```c
#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/init.h>
#include <linux/rbtree.h>

static int __init my_module_init(void)
{
    struct rb_root my_tree = RB_ROOT;
    struct rb_node *node;
    struct my_data *data;

    printk(KERN_INFO "Module loaded\n");

    // –ü—Ä–∏–º–µ—Ä –≤—Å—Ç–∞–≤–∫–∏, –ø–æ–∏—Å–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤

    return 0;
}

static void __exit my_module_exit(void)
{
    printk(KERN_INFO "Module unloaded\n");
}

module_init(my_module_init);
module_exit(my_module_exit);

MODULE_LICENSE("GPL");
MODULE_AUTHOR("Your Name");
MODULE_DESCRIPTION("A simple example of using red-black trees in kernel");
```

**–ü—Ä–∏–º–µ—Ä 2: –ú–æ–¥—É–ª—å —è–¥—Ä–∞, –∏–º–∏—Ç–∏—Ä—É—é—â–∏–π –¥—Ä–∞–π–≤–µ—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–µ—Ä–µ–≤—å–µ–≤**

```c
#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/init.h>
#include <linux/rbtree.h>

static int __init my_driver_init(void)
{
    struct rb_root my_tree = RB_ROOT;
    struct rb_node *node;
    struct my_device *dev;

    printk(KERN_INFO "Driver loaded\n");

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–µ—Ä–µ–≤–∞

    return 0;
}

static void __exit my_driver_exit(void)
{
    printk(KERN_INFO "Driver unloaded\n");
}

module_init(my_driver_init);
module_exit(my_driver_exit);

MODULE_LICENSE("GPL");
MODULE_AUTHOR("Your Name");
MODULE_DESCRIPTION("A driver example using red-black trees");
```

---

### 5. –ó–∞–¥–∞–Ω–∏—è –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã

1. **–†–µ–∞–ª–∏–∑—É–π—Ç–µ –º–æ–¥—É–ª—å —è–¥—Ä–∞**, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø–æ –∏—Ö PID. –ú–æ–¥—É–ª—å –¥–æ–ª–∂–µ–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—Å—Ç–∞–≤–∫–∏, —É–¥–∞–ª–µ–Ω–∏—è –∏ –ø–æ–∏—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

2. **–°—Ä–∞–≤–Ω–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –ø–æ–∏—Å–∫–∞ –≤ –ª–∏–Ω–µ–π–Ω–æ–º —Å–ø–∏—Å–∫–µ –∏ –≤ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω–æ–º –¥–µ—Ä–µ–≤–µ. –î–ª—è —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–π—Ç–µ –¥–≤–∞ –º–æ–¥—É–ª—è: –æ–¥–∏–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ø–∏—Å–æ–∫, –¥—Ä—É–≥–æ–π ‚Äî –¥–µ—Ä–µ–≤–æ, –∏ –∏–∑–º–µ—Ä—å—Ç–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ–∏—Å–∫–∞.

3. **–ò–∑—É—á–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–µ—Ä–µ–≤—å–µ–≤** –≤ –¥—Ä—É–≥–∏—Ö –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞—Ö —è–¥—Ä–∞, —Ç–∞–∫–∏—Ö –∫–∞–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é –∏–ª–∏ —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ Btrfs. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–π—Ç–∏ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –∏ –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –∏ –ø–æ—á–µ–º—É –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–µ—Ä–µ–≤—å—è.

---

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

* **–ö–æ–Ω—Å–ø–µ–∫—Ç –ª–µ–∫—Ü–∏–∏**: –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–µ–æ—Ä–∏–∏ –∏ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–µ—Ä–µ–≤—å–µ–≤ –≤ —è–¥—Ä–µ Linux.

* **Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**: –°–æ–¥–µ—Ä–∂–∏—Ç –∏—Å—Ö–æ–¥–Ω—ã–µ –∫–æ–¥—ã –º–æ–¥—É–ª–µ–π —è–¥—Ä–∞ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–µ—Ä–µ–≤—å–µ–≤, Makefile'—ã –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Å–±–æ—Ä–∫–µ –∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥—É–ª–µ–π.

---

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–º–æ—â—å –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞–Ω–∏–π, –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –æ–±—Ä–∞—â–∞—Ç—å—Å—è!

–î–∞–≤–∞–π—Ç–µ –¥–æ—Ä–∞–±–æ—Ç–∞–µ–º **–ü—Ä–∏–º–µ—Ä 1** –∏ **–ü—Ä–∏–º–µ—Ä 2**, —á—Ç–æ–±—ã –æ–Ω–∏ –±—ã–ª–∏ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏, –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º—ã–º–∏ –º–æ–¥—É–ª—è–º–∏ —è–¥—Ä–∞, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã—Ö –¥–µ—Ä–µ–≤—å–µ–≤ (`rbtree`) –≤ Linux.

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π –º–æ–¥—É–ª—å —è–¥—Ä–∞ —Å `rbtree`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–°–æ–∑–¥–∞—ë—Ç –¥–µ—Ä–µ–≤–æ, –≤—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —É–∑–ª–æ–≤, –≤—ã–≤–æ–¥–∏—Ç –∏—Ö –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è –∏ –æ—á–∏—â–∞–µ—Ç –¥–µ—Ä–µ–≤–æ –ø—Ä–∏ –≤—ã–≥—Ä—É–∑–∫–µ –º–æ–¥—É–ª—è.

### üìÑ `rbtree_example.c`

```c
#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/init.h>
#include <linux/slab.h>
#include <linux/rbtree.h>

MODULE_LICENSE("GPL");
MODULE_AUTHOR("–ü—Ä–∏–º–µ—Ä");
MODULE_DESCRIPTION("–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è rbtree –≤ –º–æ–¥—É–ª–µ —è–¥—Ä–∞");

struct my_node {
    int key;
    struct rb_node rb;
};

static struct rb_root my_tree = RB_ROOT;

// –í—Å—Ç–∞–≤–∫–∞ —É–∑–ª–∞
static int insert_node(int key)
{
    struct rb_node **new = &my_tree.rb_node, *parent = NULL;

    // –ü–æ–∏—Å–∫ –º–µ—Å—Ç–∞ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏
    while (*new) {
        struct my_node *this = container_of(*new, struct my_node, rb);
        parent = *new;

        if (key < this->key)
            new = &((*new)->rb_left);
        else if (key > this->key)
            new = &((*new)->rb_right);
        else
            return -1; // –£–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    }

    struct my_node *node = kmalloc(sizeof(struct my_node), GFP_KERNEL);
    if (!node)
        return -ENOMEM;

    node->key = key;
    rb_link_node(&node->rb, parent, new);
    rb_insert_color(&node->rb, &my_tree);
    return 0;
}

// –ü—Ä—è–º–æ–π –æ–±—Ö–æ–¥ –¥–µ—Ä–µ–≤–∞ (in-order traversal)
static void traverse_tree(struct rb_root *root)
{
    struct rb_node *node;
    for (node = rb_first(root); node; node = rb_next(node)) {
        struct my_node *data = container_of(node, struct my_node, rb);
        printk(KERN_INFO "Node key: %d\n", data->key);
    }
}

// –û—á–∏—Å—Ç–∫–∞ –¥–µ—Ä–µ–≤–∞
static void cleanup_tree(struct rb_root *root)
{
    struct rb_node *node = rb_first(root);
    while (node) {
        struct my_node *data = container_of(node, struct my_node, rb);
        node = rb_next(node);

        rb_erase(&data->rb, root);
        kfree(data);
    }
}

static int __init rbtree_module_init(void)
{
    printk(KERN_INFO "–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è rbtree_example\n");

    insert_node(10);
    insert_node(5);
    insert_node(15);
    insert_node(7);

    printk(KERN_INFO "–û–±—Ö–æ–¥ –¥–µ—Ä–µ–≤–∞:\n");
    traverse_tree(&my_tree);

    return 0;
}

static void __exit rbtree_module_exit(void)
{
    printk(KERN_INFO "–í—ã–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è rbtree_example\n");
    cleanup_tree(&my_tree);
}

module_init(rbtree_module_init);
module_exit(rbtree_module_exit);
```

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä 2: "–î—Ä–∞–π–≤–µ—Ä–æ–ø–æ–¥–æ–±–Ω—ã–π" –º–æ–¥—É–ª—å —Å `rbtree`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ò–º–∏—Ç–∏—Ä—É–µ—Ç —Ö—Ä–∞–Ω–µ–Ω–∏–µ "—É—Å—Ç—Ä–æ–π—Å—Ç–≤" —Å ID –≤ –¥–µ—Ä–µ–≤–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –∏—Å–∫–∞—Ç—å –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –∏–º–∏.

### üìÑ `device_tree_driver.c`

```c
#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/init.h>
#include <linux/slab.h>
#include <linux/rbtree.h>

MODULE_LICENSE("GPL");
MODULE_AUTHOR("–ö–æ—Ä–æ–±–µ–π–Ω–∏–∫–æ–≤ –ì–ª–µ–±");
MODULE_DESCRIPTION("–ü—Ä–∏–º–µ—Ä: —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º rbtree");

struct device_node {
    int id;
    char name[16];
    struct rb_node rb;
};

static struct rb_root device_tree = RB_ROOT;

// –í—Å—Ç–∞–≤–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
static int add_device(int id, const char *name)
{
    struct rb_node **new = &device_tree.rb_node, *parent = NULL;

    while (*new) {
        struct device_node *this = container_of(*new, struct device_node, rb);
        parent = *new;

        if (id < this->id)
            new = &((*new)->rb_left);
        else if (id > this->id)
            new = &((*new)->rb_right);
        else
            return -1;
    }

    struct device_node *dev = kmalloc(sizeof(struct device_node), GFP_KERNEL);
    if (!dev)
        return -ENOMEM;

    dev->id = id;
    strncpy(dev->name, name, sizeof(dev->name) - 1);
    dev->name[sizeof(dev->name) - 1] = '\0';

    rb_link_node(&dev->rb, parent, new);
    rb_insert_color(&dev->rb, &device_tree);

    return 0;
}

// –ü–æ–∏—Å–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ ID
static struct device_node *find_device(int id)
{
    struct rb_node *node = device_tree.rb_node;

    while (node) {
        struct device_node *dev = container_of(node, struct device_node, rb);

        if (id < dev->id)
            node = node->rb_left;
        else if (id > dev->id)
            node = node->rb_right;
        else
            return dev;
    }

    return NULL;
}

static void cleanup_devices(void)
{
    struct rb_node *node = rb_first(&device_tree);
    while (node) {
        struct device_node *dev = container_of(node, struct device_node, rb);
        node = rb_next(node);
        rb_erase(&dev->rb, &device_tree);
        kfree(dev);
    }
}

static int __init device_driver_init(void)
{
    printk(KERN_INFO "–ó–∞–≥—Ä—É–∑–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–∞ —Å –¥–µ—Ä–µ–≤—å—è–º–∏\n");

    add_device(100, "devA");
    add_device(50,  "devB");
    add_device(200, "devC");

    struct device_node *dev = find_device(50);
    if (dev)
        printk(KERN_INFO "–ù–∞–π–¥–µ–Ω–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: ID=%d, Name=%s\n", dev->id, dev->name);
    else
        printk(KERN_INFO "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ\n");

    return 0;
}

static void __exit device_driver_exit(void)
{
    printk(KERN_INFO "–í—ã–≥—Ä—É–∑–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–∞\n");
    cleanup_devices();
}

module_init(device_driver_init);
module_exit(device_driver_exit);
```

---

## üì¶ Makefile (–æ–±—â–∏–π –¥–ª—è –æ–±–æ–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤)

```make
obj-m += rbtree_example.o
obj-m += device_tree_driver.o

all:
	make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules

clean:
	make -C /lib/modules/$(shell uname -r)/build M=$(PWD) clean
```

---

## üß™ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

1. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –æ–±–∞ `.c` —Ñ–∞–π–ª–∞ –∏ `Makefile` –≤ –æ–¥–Ω—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é.
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–±–æ—Ä–∫—É:

```bash
make
```

3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –º–æ–¥—É–ª–µ–π:

```bash
sudo insmod rbtree_example.ko
# –∏–ª–∏
sudo insmod device_tree_driver.ko
```

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–≤–æ–¥:

```bash
dmesg | tail -n 20
```

5. –í—ã–≥—Ä—É–∑–∏—Ç–µ –º–æ–¥—É–ª—å:

```bash
sudo rmmod rbtree_example
# –∏–ª–∏
sudo rmmod device_tree_driver
```

---

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ, –º–æ–≥—É —Ç–∞–∫–∂–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –∏ Markdown-–∫–æ–Ω—Å–ø–µ–∫—Ç–æ–º. –•–æ—Ç–∏—Ç–µ?

–û—Ç–ª–∏—á–Ω–æ, –≤—ã–¥–≤–∏–≥–∞–µ–º —Ü–µ–ª—å: **–ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç—å**:

* `rbtree_example.c`
* `device_tree_driver.c`
* `Makefile`

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ `rbtree_example.c`

### ‚ùå –û—à–∏–±–∫–∏ –∏ –Ω–µ–¥–æ—á—ë—Ç—ã:

1. **–ù–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `my_node` –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –≤ `insert_node()`**

   * –†–µ—à–µ–Ω–æ.
2. **–ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –≤—Å—Ç–∞–≤–∫–∏ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ –∫–ª—é—á–∞**

   * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è -1, –Ω–æ –±–µ–∑ –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏—è.
3. **–§—É–Ω–∫—Ü–∏—è `insert_node()` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `kmalloc()` –Ω–∞ `NULL` –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º**

   * –ï—Å—Ç—å, ‚úÖ
4. **–ù–µ—Ç –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–µ—Ä–µ–≤–∞ –≤ `cleanup_tree()`**

   * –ï—Å—Ç—å, ‚úÖ
5. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ `my_node` –º–æ–≥–ª–∞ –±—ã –±—ã—Ç—å –≥–ª–æ–±–∞–ª—å–Ω–æ–π –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –≤–Ω–µ `insert_node()`**

   * –û–∫, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ.
6. ‚ùå **–ù–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è —Å–∏–º–≤–æ–ª—ã (–µ—Å–ª–∏ –≤–¥—Ä—É–≥ —Ö–æ—á–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å)** ‚Äî –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –º–æ–¥—É–ª—è –±–µ–∑ –≤–Ω–µ—à–Ω–µ–≥–æ API.

### ‚úÖ –£–ª—É—á—à–µ–Ω–∏—è:

–î–æ–±–∞–≤–∏–º:

* —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö;
* –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω—ã—Ö –≤—Å—Ç–∞–≤–æ–∫;
* –≤—ã–≤–æ–¥ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–µ—Ä–µ–≤–∞ –≤ —á–∏—Ç–∞–µ–º–æ–º –≤–∏–¥–µ.

---

### ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π `rbtree_example.c`

```c
#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/init.h>
#include <linux/slab.h>
#include <linux/rbtree.h>

MODULE_LICENSE("GPL");
MODULE_AUTHOR("–ü—Ä–∏–º–µ—Ä");
MODULE_DESCRIPTION("–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è rbtree –≤ –º–æ–¥—É–ª–µ —è–¥—Ä–∞");

struct my_node {
    int key;
    struct rb_node rb;
};

static struct rb_root my_tree = RB_ROOT;

// –í—Å—Ç–∞–≤–∫–∞ —É–∑–ª–∞
static int insert_node(int key)
{
    struct rb_node **new = &my_tree.rb_node, *parent = NULL;

    while (*new) {
        struct my_node *this = container_of(*new, struct my_node, rb);
        parent = *new;

        if (key < this->key)
            new = &((*new)->rb_left);
        else if (key > this->key)
            new = &((*new)->rb_right);
        else {
            printk(KERN_INFO "–ö–ª—é—á %d —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç\n", key);
            return -1;
        }
    }

    struct my_node *node = kmalloc(sizeof(*node), GFP_KERNEL);
    if (!node)
        return -ENOMEM;

    node->key = key;
    rb_link_node(&node->rb, parent, new);
    rb_insert_color(&node->rb, &my_tree);

    printk(KERN_INFO "–î–æ–±–∞–≤–ª–µ–Ω –∫–ª—é—á: %d\n", key);
    return 0;
}

// –û–±—Ö–æ–¥ –¥–µ—Ä–µ–≤–∞ (in-order)
static void traverse_tree(struct rb_root *root)
{
    struct rb_node *node;
    for (node = rb_first(root); node; node = rb_next(node)) {
        struct my_node *data = container_of(node, struct my_node, rb);
        printk(KERN_INFO "Node: %d\n", data->key);
    }
}

// –û—á–∏—Å—Ç–∫–∞ –¥–µ—Ä–µ–≤–∞
static void cleanup_tree(struct rb_root *root)
{
    struct rb_node *node = rb_first(root);
    while (node) {
        struct my_node *data = container_of(node, struct my_node, rb);
        node = rb_next(node);

        rb_erase(&data->rb, root);
        kfree(data);
    }
}

static int __init rbtree_module_init(void)
{
    printk(KERN_INFO "=== –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è rbtree_example ===\n");

    insert_node(10);
    insert_node(5);
    insert_node(15);
    insert_node(7);

    printk(KERN_INFO "–û–±—Ö–æ–¥ –¥–µ—Ä–µ–≤–∞:\n");
    traverse_tree(&my_tree);

    return 0;
}

static void __exit rbtree_module_exit(void)
{
    printk(KERN_INFO "=== –í—ã–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è rbtree_example ===\n");
    cleanup_tree(&my_tree);
}

module_init(rbtree_module_init);
module_exit(rbtree_module_exit);
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ `device_tree_driver.c`

### ‚ùå –û—à–∏–±–∫–∏ –∏ –Ω–µ–¥–æ—á—ë—Ç—ã:

1. ‚ùå **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç `#include <linux/string.h>`** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `strncpy`.
2. ‚ùå **–ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ**
3. ‚ùå **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É, –µ—Å–ª–∏ –¥—É–±–ª–∏–∫–∞—Ç**
4. ‚ùå **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤—ã–≤–æ–¥ –¥–µ—Ä–µ–≤–∞ (–≤ –æ—Ç–ª–∞–¥–æ—á–Ω—ã—Ö —Ü–µ–ª—è—Ö)**

---

### ‚úÖ –£–ª—É—á—à–µ–Ω–Ω—ã–π `device_tree_driver.c`

```c
#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/init.h>
#include <linux/slab.h>
#include <linux/string.h>
#include <linux/rbtree.h>

MODULE_LICENSE("GPL");
MODULE_AUTHOR("–ö–æ—Ä–æ–±–µ–π–Ω–∏–∫–æ–≤ –ì–ª–µ–±");
MODULE_DESCRIPTION("–ü—Ä–∏–º–µ—Ä: —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º rbtree");

struct device_node {
    int id;
    char name[16];
    struct rb_node rb;
};

static struct rb_root device_tree = RB_ROOT;

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
static int add_device(int id, const char *name)
{
    struct rb_node **new = &device_tree.rb_node, *parent = NULL;

    while (*new) {
        struct device_node *this = container_of(*new, struct device_node, rb);
        parent = *new;

        if (id < this->id)
            new = &((*new)->rb_left);
        else if (id > this->id)
            new = &((*new)->rb_right);
        else {
            printk(KERN_INFO "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å ID %d —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç\n", id);
            return -1;
        }
    }

    struct device_node *dev = kmalloc(sizeof(*dev), GFP_KERNEL);
    if (!dev)
        return -ENOMEM;

    dev->id = id;
    strncpy(dev->name, name, sizeof(dev->name) - 1);
    dev->name[sizeof(dev->name) - 1] = '\0';

    rb_link_node(&dev->rb, parent, new);
    rb_insert_color(&dev->rb, &device_tree);

    printk(KERN_INFO "–î–æ–±–∞–≤–ª–µ–Ω–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: ID=%d, Name=%s\n", dev->id, dev->name);
    return 0;
}

static struct device_node *find_device(int id)
{
    struct rb_node *node = device_tree.rb_node;

    while (node) {
        struct device_node *dev = container_of(node, struct device_node, rb);

        if (id < dev->id)
            node = node->rb_left;
        else if (id > dev->id)
            node = node->rb_right;
        else
            return dev;
    }

    return NULL;
}

static void traverse_devices(void)
{
    struct rb_node *node;
    for (node = rb_first(&device_tree); node; node = rb_next(node)) {
        struct device_node *dev = container_of(node, struct device_node, rb);
        printk(KERN_INFO "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: ID=%d, Name=%s\n", dev->id, dev->name);
    }
}

static void cleanup_devices(void)
{
    struct rb_node *node = rb_first(&device_tree);
    while (node) {
        struct device_node *dev = container_of(node, struct device_node, rb);
        node = rb_next(node);
        rb_erase(&dev->rb, &device_tree);
        kfree(dev);
    }
}

static int __init device_driver_init(void)
{
    printk(KERN_INFO "=== –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞-–¥—Ä–∞–π–≤–µ—Ä–∞ ===\n");

    add_device(100, "devA");
    add_device(50,  "devB");
    add_device(200, "devC");

    struct device_node *dev = find_device(50);
    if (dev)
        printk(KERN_INFO "–ù–∞–π–¥–µ–Ω–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: ID=%d, Name=%s\n", dev->id, dev->name);
    else
        printk(KERN_INFO "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ\n");

    traverse_devices();

    return 0;
}

static void __exit device_driver_exit(void)
{
    printk(KERN_INFO "=== –í—ã–≥—Ä—É–∑–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞-–¥—Ä–∞–π–≤–µ—Ä–∞ ===\n");
    cleanup_devices();
}

module_init(device_driver_init);
module_exit(device_driver_exit);
```

---

## ‚úÖ Makefile ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### ‚ùå –û—à–∏–±–∫–∏:

* –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ–±—Ä–∞—Ç—å –¥–≤–∞ –º–æ–¥—É–ª—è –∏–∑ –æ–¥–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞, `obj-m` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∞—Å—Å–∏–≤–æ–º.

---

### ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π `Makefile`

```make
obj-m += rbtree_example.o
obj-m += device_tree_driver.o

KDIR := /lib/modules/$(shell uname -r)/build
PWD := $(shell pwd)

all:
	$(MAKE) -C $(KDIR) M=$(PWD) modules

clean:
	$(MAKE) -C $(KDIR) M=$(PWD) clean
```

---

## üìå –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å:

* ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ, —Ä–∞–±–æ—á–∏–µ –∏ —É–¥–æ–±–Ω—ã–µ –¥–ª—è —á—Ç–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ –º–æ–¥—É–ª–µ–π `rbtree_example.c` –∏ `device_tree_driver.c`
* ‚úÖ Makefile, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–±–∏—Ä–∞–µ—Ç –æ–±–∞ –º–æ–¥—É–ª—è
* ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å—Ç–∞–≤–∫–∏, –ø–æ–∏—Å–∫, –æ–±—Ö–æ–¥ –∏ –æ—á–∏—Å—Ç–∫–∞ –¥–µ—Ä–µ–≤—å–µ–≤
* ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∏ —á–µ—Ä–µ–∑ `dmesg`

–•–æ—Ç–∏—Ç–µ, —è –æ—Ñ–æ—Ä–º–ª—é –≤—Å—ë –≤ `README.md` –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (—Å git-—Ä–µ–ø–æ —à–∞–±–ª–æ–Ω–æ–º)?

–í–æ—Ç –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö API —è–¥—Ä–∞ Linux –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã–º–∏ –¥–µ—Ä–µ–≤—å—è–º–∏ (`rbtree`) –∏–∑ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ `<linux/rbtree.h>`, —Å –ø–æ—è—Å–Ω–µ–Ω–∏–µ–º –∫–∞–∂–¥–æ–≥–æ –≤—ã–∑–æ–≤–∞, –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –ø—Ä–∏–º–µ—Ä–æ–≤ –∫–æ–¥–∞ –∏ –∫—Ä–∞—Ç–∫–∏–º–∏ –∑–∞–º–µ—á–∞–Ω–∏—è–º–∏, –≥–¥–µ –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —è–¥—Ä–µ.

---

## üî∏ 1. `RB_ROOT`

### üìå –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–°–æ–∑–¥–∞—ë—Ç –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—É—Å—Ç–æ–µ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ.

### üìÑ –°–∏–≥–Ω–∞—Ç—É—Ä–∞ (–º–∞–∫—Ä–æ—Å)

```c
#define RB_ROOT (struct rb_root) { NULL }
```

### üì• –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

–ù–µ—Ç. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–µ—Ä–µ–≤–∞.

### ‚úÖ –ü—Ä–∏–º–µ—Ä

```c
#include <linux/rbtree.h>

struct rb_root my_tree = RB_ROOT;
```

### üìç –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

* –í —è–¥—Ä–µ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ª—é–±—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö `rbtree`, –Ω–∞–ø—Ä–∏–º–µ—Ä:

  * –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤;
  * —Ñ–∞–π–ª–æ–≤—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã (`anon_vma`);
  * –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á (–Ω–∞–ø—Ä–∏–º–µ—Ä, `CFS` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `struct rb_root`).

---

## üî∏ 2. `rb_insert_color(struct rb_node *node, struct rb_root *root)`

### üìå –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –¥–µ—Ä–µ–≤–∞ –ø–æ—Å–ª–µ –≤—Å—Ç–∞–≤–∫–∏ –Ω–æ–≤–æ–≥–æ —É–∑–ª–∞. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ `rb_link_node()`.

### üì• –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

* `node` ‚Äî —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –≤—Å—Ç–∞–≤–ª—è–µ–º—ã–π —É–∑–µ–ª (`rb_node`)
* `root` ‚Äî —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞ (`rb_root`)

### ‚úÖ –ü—Ä–∏–º–µ—Ä

```c
struct my_node {
    int key;
    struct rb_node rb;
};

struct rb_root my_tree = RB_ROOT;

void insert(struct my_node *data)
{
    struct rb_node **new = &my_tree.rb_node;
    struct rb_node *parent = NULL;

    while (*new) {
        struct my_node *this = container_of(*new, struct my_node, rb);
        parent = *new;
        if (data->key < this->key)
            new = &(*new)->rb_left;
        else
            new = &(*new)->rb_right;
    }

    rb_link_node(&data->rb, parent, new);
    rb_insert_color(&data->rb, &my_tree);
}
```

### üìç –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

* –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤–µ–∑–¥–µ, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `rbtree`: –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å, –±–ª–æ–∫–∏ –ø–∞–º—è—Ç–∏, —Å–ª–æ—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ —Ç.–ø.

---

## üî∏ 3. `rb_erase(struct rb_node *node, struct rb_root *root)`

### üìå –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–£–¥–∞–ª—è–µ—Ç —É–∑–µ–ª –∏–∑ –¥–µ—Ä–µ–≤–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –µ–≥–æ —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É.

### üì• –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

* `node` ‚Äî —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —É–¥–∞–ª—è–µ–º—ã–π —É–∑–µ–ª (`rb_node`)
* `root` ‚Äî –∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ —É–¥–∞–ª—è–µ—Ç—Å—è —É–∑–µ–ª

### ‚úÖ –ü—Ä–∏–º–µ—Ä

```c
void delete_node(struct my_node *data)
{
    rb_erase(&data->rb, &my_tree);
    kfree(data);
}
```

### üìç –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

* –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –∞–¥—Ä–µ—Å–Ω—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤;
* –û—á–∏—Å—Ç–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –æ—Ç –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á;
* –£–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –≤ —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.

---

## üî∏ 4. `rb_next(struct rb_node *node)`, `rb_prev(struct rb_node *node)`

### üìå –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ (`rb_next`) –∏–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ (`rb_prev`) —É–∑–ª–∞ –¥–µ—Ä–µ–≤–∞ –ø–æ –ø–æ—Ä—è–¥–∫—É (in-order traversal).

### üì• –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

* `node` ‚Äî —Ç–µ–∫—É—â–∏–π —É–∑–µ–ª –¥–µ—Ä–µ–≤–∞

### ‚úÖ –ü—Ä–∏–º–µ—Ä

```c
void traverse(struct rb_root *root)
{
    struct rb_node *node;
    for (node = rb_first(root); node; node = rb_next(node)) {
        struct my_node *data = container_of(node, struct my_node, rb);
        printk(KERN_INFO "Key: %d\n", data->key);
    }
}
```

* `rb_prev()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –æ–±–æ–π—Ç–∏ –¥–µ—Ä–µ–≤–æ –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.

### üìç –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

* –û–±—Ö–æ–¥ `rbtree` –ø—Ä–∏ –≤—ã–≤–æ–¥–µ, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏–ª–∏ –º–∞—Å—Å–æ–≤–æ–º —É–¥–∞–ª–µ–Ω–∏–∏;
* –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–ª–∞—Å—Ç–µ–π –ø–∞–º—è—Ç–∏, –∑–æ–Ω, —Ñ—Ä–µ–π–º–æ–≤, –∑–∞–¥–∞—á.

---

## üî∏ 5. `rb_first(struct rb_root *root)`, `rb_last(struct rb_root *root)`

### üìå –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∞–º–æ–≥–æ –ª–µ–≤–æ–≥–æ (`rb_first`) –∏–ª–∏ —Å–∞–º–æ–≥–æ –ø—Ä–∞–≤–æ–≥–æ (`rb_last`) —É–∑–ª–∞ ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.

### üì• –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

* `root` ‚Äî –∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞ (`rb_root`)

### ‚úÖ –ü—Ä–∏–º–µ—Ä

```c
struct rb_node *first = rb_first(&my_tree);
if (first) {
    struct my_node *data = container_of(first, struct my_node, rb);
    printk(KERN_INFO "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–ª—é—á: %d\n", data->key);
}
```

### üìç –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

* –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á (–ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º `vruntime`);
* –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø–∞–º—è—Ç—å—é;
* –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—á–µ—Ä–µ–¥–µ–π —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º (`priority queue`).

---

## üìö –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è API `rbtree.h` –≤ —è–¥—Ä–µ Linux

| –ü–æ–¥—Å–∏—Å—Ç–µ–º–∞           | –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ | –°—Ç—Ä—É–∫—Ç—É—Ä—ã/—Ñ–∞–π–ª—ã —è–¥—Ä–∞              |
| -------------------- | ------------------------------------- | --------------------------------- |
| –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á    | `Completely Fair Scheduler` (CFS)     | `kernel/sched/fair.c`             |
| –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å   | –•—Ä–∞–Ω–µ–Ω–∏–µ `vm_area_struct` –ø–æ –∞–¥—Ä–µ—Å–∞–º  | `mm/mmap.c`                       |
| –§–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã     | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, –±–ª–æ–∫–∏ –≤ Btrfs, XFS        | `fs/btrfs/`, `fs/xfs/`            |
| –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏ | –°–ª–æ—Ç—ã –ø–∞–º—è—Ç–∏, control groups          | `kernel/cgroup/`                  |
| –û—á–µ—Ä–µ–¥–∏ –∏ —Ç–∞–π–º–µ—Ä—ã    | –£–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–µ —Ç–∞–π–º–µ—Ä—ã, —Å–∏–≥–Ω–∞–ª—ã        | `kernel/time/`, `kernel/signal.c` |

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —è –º–æ–≥—É –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—É—é –¥–∏–∞–≥—Ä–∞–º–º—É (PNG/SVG) —Å —Ç–µ–º, –∫–∞–∫ API rbtree —Å–≤—è–∑–∞–Ω—ã –º–µ–∂–¥—É —Å–æ–±–æ–π ‚Äî –∏–ª–∏ Markdown-–∫–æ–Ω—Å–ø–µ–∫—Ç —Å —ç—Ç–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º. –•–æ—Ç–∏—Ç–µ?


–û—Ç–ª–∏—á–Ω–æ! –ù–∏–∂–µ ‚Äî **–ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ API rbtree –≤ —è–¥—Ä–µ Linux**, —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ **—Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä** –∏ **—Ñ–∞–π–ª–æ–≤ —è–¥—Ä–∞**, –≥–¥–µ —ç—Ç–∏ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.

---

## üî∑ `RB_ROOT`

### üìå –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ –¥–µ—Ä–µ–≤–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä, –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫, –≤—Å—Ç–∞–≤–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ.

### üìç –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —è–¥—Ä–µ Linux:

#### 1. **–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤**

* –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `mm_struct` —Å–æ–¥–µ—Ä–∂–∏—Ç `struct rb_root mm_rb`, –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤—Å–µ `vm_area_struct` –ø—Ä–æ—Ü–µ—Å—Å–∞.
* –ö–∞–∂–¥—ã–π —É—á–∞—Å—Ç–æ–∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ (VMA) ‚Äî —ç—Ç–æ —É–∑–µ–ª –≤ –¥–µ—Ä–µ–≤–µ.

üìÅ –§–∞–π–ª: `mm/mmap.c`, `mm/internal.h`

```c
struct mm_struct {
    struct rb_root mm_rb;   // –í—Å–µ VMA —Ö—Ä–∞–Ω—è—Ç—Å—è –∑–¥–µ—Å—å
    ...
};
```

#### 2. **–§–∞–π–ª–æ–≤—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã (anon\_vma)**

* –ê–Ω–æ–Ω–∏–º–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ –ø–∞–º—è—Ç–∏ (`anon_vma`) —Ç–∞–∫–∂–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –¥–µ—Ä–µ–≤—å—è—Ö.
* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ fork().

üìÅ –§–∞–π–ª: `mm/rmap.c`, `mm/anon_vma.c`

```c
struct anon_vma_chain {
    struct rb_node rb;
    ...
};
```

#### 3. **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á (CFS)**

* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `RB_ROOT` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ—Ö runnable –∑–∞–¥–∞—á –ø–æ `vruntime`.

üìÅ –§–∞–π–ª: `kernel/sched/fair.c`

```c
struct cfs_rq {
    struct rb_root tasks_timeline;  // –¥–µ—Ä–µ–≤–æ –∑–∞–¥–∞—á CFS
    ...
};
```

---

## üî∑ `rb_insert_color(struct rb_node *node, struct rb_root *root)`

### üìå –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ë–∞–ª–∞–Ω—Å–∏—Ä—É–µ—Ç –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –ø–æ—Å–ª–µ –≤—Å—Ç–∞–≤–∫–∏ —É–∑–ª–∞. –û–±—è–∑–∞—Ç–µ–ª–µ–Ω –ø–æ—Å–ª–µ `rb_link_node()`.

### üìç –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:

#### 1. **CFS –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫**

* –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤ `tasks_timeline` –¥–µ—Ä–µ–≤–∞ –ø–æ `vruntime`.

üìÅ –§–∞–π–ª: `kernel/sched/fair.c`

```c
rb_insert_color(&se->run_node, &cfs_rq->tasks_timeline);
```

#### 2. **–û–±–ª–∞—Å—Ç–∏ –ø–∞–º—è—Ç–∏ (`vm_area_struct`)**

* –ö–∞–∂–¥–∞—è –Ω–æ–≤–∞—è VMA –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ `mm->mm_rb` –ø—Ä–∏ `mmap()` –∏–ª–∏ `brk()`.

üìÅ –§–∞–π–ª: `mm/mmap.c`

```c
rb_insert_color(&vma->vm_rb, &mm->mm_rb);
```

#### 3. **–ë–ª–æ–∫–∏ –ø–∞–º—è—Ç–∏**

* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ buddy-–∞–ª–ª–æ–∫–∞—Ç–æ—Ä–µ –∏ zsmalloc.

üìÅ –§–∞–π–ª—ã: `mm/page_alloc.c`, `mm/zsmalloc.c`

---

## üî∑ `rb_erase(struct rb_node *node, struct rb_root *root)`

### üìå –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–£–¥–∞–ª—è–µ—Ç —É–∑–µ–ª –∏–∑ –¥–µ—Ä–µ–≤–∞ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É.

### üìç –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:

#### 1. **–£–¥–∞–ª–µ–Ω–∏–µ VMA**

* –ü—Ä–∏ `munmap()` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —É—á–∞—Å—Ç–æ–∫ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ –¥–µ—Ä–µ–≤–∞ `mm->mm_rb`.

üìÅ –§–∞–π–ª: `mm/mmap.c`

```c
rb_erase(&vma->vm_rb, &mm->mm_rb);
```

#### 2. **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á**

* –ö–æ–≥–¥–∞ –∑–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∏–ª–∏ –≤—ã—Ç–µ—Å–Ω–µ–Ω–∞, –µ—ë `sched_entity` —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ –¥–µ—Ä–µ–≤–∞.

üìÅ –§–∞–π–ª: `kernel/sched/fair.c`

```c
rb_erase(&se->run_node, &cfs_rq->tasks_timeline);
```

#### 3. **–§–∞–π–ª–æ–≤—ã–µ –∏ inode –∫—ç—à–∏**

* –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ inode –∏–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü –∏–∑ –∫—ç—à–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ ext4, Btrfs).

üìÅ –§–∞–π–ª—ã: `fs/btrfs/extent-tree.c`, `fs/ext4/`

---

## üî∑ `rb_next(struct rb_node *node)`, `rb_prev(struct rb_node *node)`

### üìå –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ö–æ–¥–∏—Ç—å –¥–µ—Ä–µ–≤–æ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é (`rb_next`) –∏–ª–∏ —É–±—ã–≤–∞–Ω–∏—é (`rb_prev`).

### üìç –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:

#### 1. **–û–±—Ö–æ–¥ –≤—Å–µ—Ö VMA –ø—Ä–æ—Ü–µ—Å—Å–∞**

* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ `/proc/[pid]/maps`, –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞.

üìÅ –§–∞–π–ª: `mm/mmap.c`

```c
for (vma = rb_entry(rb_first(&mm->mm_rb), struct vm_area_struct, vm_rb);
     vma;
     vma = rb_entry(rb_next(&vma->vm_rb), struct vm_area_struct, vm_rb))
```

#### 2. **–£–¥–∞–ª–µ–Ω–∏–µ –∏–ª–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–¥–∞—á**

* –í CFS –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏ `tasks_timeline` –≤ –ø–æ—Ä—è–¥–∫–µ `vruntime`.

üìÅ –§–∞–π–ª: `kernel/sched/fair.c`

---

## üî∑ `rb_first(struct rb_root *root)`, `rb_last(struct rb_root *root)`

### üìå –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ù–∞—Ö–æ–¥–∏—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π (`rb_first`) –∏–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π (`rb_last`) —É–∑–µ–ª –≤ –¥–µ—Ä–µ–≤–µ.

### üìç –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:

#### 1. **–í—ã–±–æ—Ä –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–¥–∞—á–∏ –≤ CFS**

* CFS –≤—ã–±–∏—Ä–∞–µ—Ç –∑–∞–¥–∞—á—É —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º `vruntime` (–ª–µ–≤—ã–π –∫—Ä–∞–π –¥–µ—Ä–µ–≤–∞).

üìÅ –§–∞–π–ª: `kernel/sched/fair.c`

```c
struct sched_entity *se = rb_entry(rb_first(&cfs_rq->tasks_timeline), struct sched_entity, run_node);
```

#### 2. **–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ —Ç–∞–π–º–µ—Ä–∞—Ö**

* –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∞–π–º–µ—Ä–æ–≤ –∏–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `rb_first()` –¥–ª—è –≤—ã–±–æ—Ä–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–±—ã—Ç–∏—è.

üìÅ –§–∞–π–ª: `kernel/time/timer.c`, `kernel/locking/lockdep.c`

#### 3. **–û—á–µ—Ä–µ–¥–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤**

* –í–æ–∑–º–æ–∂–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–π –æ—á–µ—Ä–µ–¥–∏ –Ω–∞ –±–∞–∑–µ `rbtree`: `rb_first()` ‚Üí —Å–∞–º—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç.

---

## üß© –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

| API                 | –ì–¥–µ –≤ —è–¥—Ä–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è                                                |
| ------------------- | --------------------------------------------------------------------- |
| `RB_ROOT`           | –°—Ç–∞—Ä—Ç–æ–≤–∞—è —Ç–æ—á–∫–∞: VMA (`mm_rb`), CFS (`tasks_timeline`), —Ñ–∞–π–ª–æ–≤—ã–µ –∫—ç—à–∏ |
| `rb_insert_color()` | –í—Å—Ç–∞–≤–∫–∞ –≤ `mm_rb`, CFS –¥–µ—Ä–µ–≤–æ –∑–∞–¥–∞—á, inode –∏ memory caches            |
| `rb_erase()`        | `munmap()`, `exit()`, —É–¥–∞–ª–µ–Ω–∏–µ inode/pages                            |
| `rb_next()/prev()`  | –û–±—Ö–æ–¥ –≤—Å–µ—Ö VMA, –∑–∞–¥–∞—á, –æ–±–ª–∞—Å—Ç–µ–π –ø–∞–º—è—Ç–∏                                |
| `rb_first()/last()` | –í—ã–±–æ—Ä min/max: CFS, —Ç–∞–π–º–µ—Ä—ã, Btrfs, lockdeps                          |

---

üìå –ï—Å–ª–∏ –Ω—É–∂–Ω–æ ‚Äî –º–æ–≥—É:

* —Å–æ–±—Ä–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä —Å—Å—ã–ª–æ–∫ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ –∫–æ–¥–µ —è–¥—Ä–∞ (mainline Linux);
* –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—É—é –∫–∞—Ä—Ç—É: –≥–¥–µ `rb_root` –∏ `rb_node` –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è;
* —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –∏–ª–∏ Markdown-–∫–æ–Ω—Å–ø–µ–∫—Ç –ø–æ —ç—Ç–æ–π —Ç–µ–º–µ.

–•–æ—Ç–∏—Ç–µ —á—Ç–æ-—Ç–æ –∏–∑ —ç—Ç–æ–≥–æ?


–í–æ—Ç —Å–ø–∏—Å–æ–∫ —Ä–µ—Å—É—Ä—Å–æ–≤, –≥–¥–µ –≤—ã –º–æ–∂–µ—Ç–µ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å —Ç–µ–º–æ–π ¬´–î–µ—Ä–µ–≤—å—è –≤ —è–¥—Ä–µ Linux¬ª ‚Äî –∫–∞–∫ –±–∏–Ω–∞—Ä–Ω—ã–º–∏, —Ç–∞–∫ –∏ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã–º–∏:

---

## üìö –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥

1. **–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ —è–¥—Ä–∞ Linux**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã—Ö –¥–µ—Ä–µ–≤—å–µ–≤ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `include/linux/rbtree.h`. –¢–∞–º –∂–µ –æ–ø–∏—Å–∞–Ω—ã –º–∞–∫—Ä–æ—Å—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–µ—Ä–µ–≤—å—è–º–∏.

2. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —è–¥—Ä–∞ Linux**: –í –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —è–¥—Ä–∞ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö `rb_root` –∏ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã–º–∏ –¥–µ—Ä–µ–≤—å—è–º–∏.

---

## üìò –ö–Ω–∏–≥–∏

1. **"Linux Kernel Development" (3-–µ –∏–∑–¥–∞–Ω–∏–µ) ‚Äî –†–æ–±–µ—Ä—Ç –õ–∞–≤**: –≠—Ç–∞ –∫–Ω–∏–≥–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞—Å–ø–µ–∫—Ç–æ–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —è–¥—Ä–∞ Linux, –≤–∫–ª—é—á–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã.

2. **"Understanding the Linux Kernel" ‚Äî –î—ç–≤–∏–¥ –ü–∞—Ç—Ç–µ—Ä—Å–æ–Ω –∏ –ö–∞—Ä–ª –ë—Ä–∞—É–Ω**: –ö–Ω–∏–≥–∞ –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —è–¥—Ä–∞ Linux, –≤–∫–ª—é—á–∞—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö.

---

## üåê –û–Ω–ª–∞–π–Ω-—Ä–µ—Å—É—Ä—Å—ã –∏ —Å—Ç–∞—Ç—å–∏

1. **–°—Ç–∞—Ç—å—è –Ω–∞ Linux Journal**: "Red-Black Trees in the Linux Kernel" ‚Äî —Å—Ç–∞—Ç—å—è, –æ–±—ä—è—Å–Ω—è—é—â–∞—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã—Ö –¥–µ—Ä–µ–≤—å–µ–≤ –≤ —è–¥—Ä–µ Linux.

2. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ kernel.org**: –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —è–¥—Ä–∞ Linux, –≤–∫–ª—é—á–∞—è –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö –∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.

---

–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–æ–æ–±—â–∏—Ç–µ, –∏ —è –ø–æ—Å—Ç–∞—Ä–∞—é—Å—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –∏—Ö.


–ö–æ–Ω–µ—á–Ω–æ, –≤–æ—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –≤–∞–º –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å —Ç–µ–º–æ–π ¬´–î–µ—Ä–µ–≤—å—è –≤ —è–¥—Ä–µ Linux¬ª:

---

### üìò –ö–Ω–∏–≥–∏

1. **"–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —è–¥—Ä–∞ Linux" (3-–µ –∏–∑–¥–∞–Ω–∏–µ) ‚Äî –†–æ–±–µ—Ä—Ç –õ–∞–≤**

   –≠—Ç–æ –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∫–Ω–∏–≥ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —è–¥—Ä–∞ Linux, –æ—Ö–≤–∞—Ç—ã–≤–∞—é—â–∞—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã, –≤–∫–ª—é—á–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö, –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é.

   * [–ß–∏—Ç–∞—Ç—å –æ–Ω–ª–∞–π–Ω –Ω–∞ Coollib](https://coollib.cc/b/297517-robert-lav-razrabotka-yadra-linux/read)
   * [PDF-–≤–µ—Ä—Å–∏—è –Ω–∞ —Å–∞–π—Ç–µ –ò–∞–∫–æ–≤–∞ –ò–∞–∫–æ–≤–∞](https://www.iakovlev.org/zip/RobertLove.pdf)
   * [PDF-–≤–µ—Ä—Å–∏—è –Ω–∞ —Å–∞–π—Ç–µ Mishatronic](https://mishatronic.ucoz.ua/books/LinuxKernelDevelopment.pdf)

2. **"–ü–æ–Ω–∏–º–∞–Ω–∏–µ —è–¥—Ä–∞ Linux" ‚Äî –î—ç–≤–∏–¥ –ü–∞—Ç—Ç–µ—Ä—Å–æ–Ω –∏ –ö–∞—Ä–ª –ë—Ä–∞—É–Ω**

   –≠—Ç–∞ –∫–Ω–∏–≥–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —è–¥—Ä–∞ Linux, –≤–∫–ª—é—á–∞—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö.

   * [PDF-–≤–µ—Ä—Å–∏—è –Ω–∞ —Å–∞–π—Ç–µ –ò–∞–∫–æ–≤–∞ –ò–∞–∫–æ–≤–∞](https://www.iakovlev.org/zip/Understanding_the_Linux_Kernel.pdf)

---

### üåê –û–Ω–ª–∞–π–Ω-—Ä–µ—Å—É—Ä—Å—ã

–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —è –Ω–µ —Å–º–æ–≥ –Ω–∞–π—Ç–∏ —Å—Ç–∞—Ç—å—é ¬´Red-Black Trees in the Linux Kernel¬ª –Ω–∞ —Å–∞–π—Ç–µ Linux Journal. –í–æ–∑–º–æ–∂–Ω–æ, –æ–Ω–∞ –±–æ–ª—å—à–µ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –∏–ª–∏ –±—ã–ª–∞ —É–¥–∞–ª–µ–Ω–∞.

---

–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏–ª–∏ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–æ–æ–±—â–∏—Ç–µ, –∏ —è –ø–æ—Å—Ç–∞—Ä–∞—é—Å—å –ø–æ–º–æ—á—å.

